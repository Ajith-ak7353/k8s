Started by user ajith
Obtained Jenkinsfile from git https://github.com/Ajith-ak7353/k8s.git
[Pipeline] Start of Pipeline
[Pipeline] node
Running on Jenkins in /var/lib/jenkins/workspace/k8s
[Pipeline] {
[Pipeline] stage
[Pipeline] { (Declarative: Checkout SCM)
[Pipeline] checkout
Selected Git installation does not exist. Using Default
The recommended git tool is: NONE
No credentials specified
 > git rev-parse --resolve-git-dir /var/lib/jenkins/workspace/k8s/.git # timeout=10
Fetching changes from the remote Git repository
 > git config remote.origin.url https://github.com/Ajith-ak7353/k8s.git # timeout=10
Fetching upstream changes from https://github.com/Ajith-ak7353/k8s.git
 > git --version # timeout=10
 > git --version # 'git version 2.43.0'
 > git fetch --tags --force --progress -- https://github.com/Ajith-ak7353/k8s.git +refs/heads/*:refs/remotes/origin/* # timeout=10
 > git rev-parse refs/remotes/origin/master^{commit} # timeout=10
Checking out Revision 2483be90f0a85af1ef9889940f238ee9aeab6bd3 (refs/remotes/origin/master)
 > git config core.sparsecheckout # timeout=10
 > git checkout -f 2483be90f0a85af1ef9889940f238ee9aeab6bd3 # timeout=10
Commit message: "Update deployment.yaml"
 > git rev-list --no-walk 215a700f2ff3f4a7418bb813734fb4bc3516fb02 # timeout=10
[Pipeline] }
[Pipeline] // stage
[Pipeline] withEnv
[Pipeline] {
[Pipeline] withEnv
[Pipeline] {
[Pipeline] stage
[Pipeline] { (Checkout Code)
[Pipeline] git
Selected Git installation does not exist. Using Default
The recommended git tool is: NONE
No credentials specified
 > git rev-parse --resolve-git-dir /var/lib/jenkins/workspace/k8s/.git # timeout=10
Fetching changes from the remote Git repository
 > git config remote.origin.url https://github.com/Ajith-ak7353/k8s.git # timeout=10
Fetching upstream changes from https://github.com/Ajith-ak7353/k8s.git
 > git --version # timeout=10
 > git --version # 'git version 2.43.0'
 > git fetch --tags --force --progress -- https://github.com/Ajith-ak7353/k8s.git +refs/heads/*:refs/remotes/origin/* # timeout=10
 > git rev-parse refs/remotes/origin/master^{commit} # timeout=10
Checking out Revision 2483be90f0a85af1ef9889940f238ee9aeab6bd3 (refs/remotes/origin/master)
 > git config core.sparsecheckout # timeout=10
 > git checkout -f 2483be90f0a85af1ef9889940f238ee9aeab6bd3 # timeout=10
 > git branch -a -v --no-abbrev # timeout=10
 > git branch -D master # timeout=10
 > git checkout -b master 2483be90f0a85af1ef9889940f238ee9aeab6bd3 # timeout=10
Commit message: "Update deployment.yaml"
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Build Docker Image)
[Pipeline] script
[Pipeline] {
[Pipeline] isUnix
[Pipeline] withEnv
[Pipeline] {
[Pipeline] sh
+ docker build -t ajith7353/webpract:latest .
#0 building with "default" instance using docker driver

#1 [internal] load build definition from Dockerfile
#1 transferring dockerfile: 30B 0.1s
#1 transferring dockerfile: 260B 0.1s done
#1 DONE 0.2s

#2 [internal] load metadata for docker.io/library/nginx:alpine
#2 DONE 2.7s

#3 [internal] load .dockerignore
#3 transferring context: 2B done
#3 DONE 0.0s

#4 [1/2] FROM docker.io/library/nginx:alpine@sha256:1d13701a5f9f3fb01aaa88cef2344d65b6b5bf6b7d9fa4cf0dca557a8d7702ba
#4 DONE 0.0s

#5 [internal] load build context
#5 transferring context: 19.77kB 0.0s done
#5 DONE 0.0s

#4 [1/2] FROM docker.io/library/nginx:alpine@sha256:1d13701a5f9f3fb01aaa88cef2344d65b6b5bf6b7d9fa4cf0dca557a8d7702ba
#4 CACHED

#6 [2/2] COPY . /usr/share/nginx/html/
#6 DONE 0.3s

#7 exporting to image
#7 exporting layers 0.1s done
#7 writing image sha256:e6a734b14af4c089c3c7b9ff9505ca7d06fa107ee9b3098b9728bff8df539e86 done
#7 naming to docker.io/ajith7353/webpract:latest 0.0s done
#7 DONE 0.2s
[Pipeline] }
[Pipeline] // withEnv
Did you forget the `def` keyword? WorkflowScript seems to be setting a field named dockerImage (to a value of type Image) which could lead to memory leaks or other issues.
[Pipeline] }
[Pipeline] // script
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Push Image to DockerHub)
[Pipeline] script
[Pipeline] {
[Pipeline] withDockerRegistry
$ docker login -u ajith7353 -p ******** https://index.docker.io/v1/
WARNING! Using --password via the CLI is insecure. Use --password-stdin.

WARNING! Your credentials are stored unencrypted in '/var/lib/jenkins/workspace/k8s@tmp/9fb80e34-07da-438d-89d6-40d6837de6f1/config.json'.
Configure a credential helper to remove this warning. See
https://docs.docker.com/go/credential-store/

Login Succeeded
[Pipeline] {
[Pipeline] isUnix
[Pipeline] withEnv
[Pipeline] {
[Pipeline] sh
+ docker tag ajith7353/webpract:latest ajith7353/webpract:latest
[Pipeline] }
[Pipeline] // withEnv
[Pipeline] isUnix
[Pipeline] withEnv
[Pipeline] {
[Pipeline] sh
+ docker push ajith7353/webpract:latest
The push refers to repository [docker.io/ajith7353/webpract]
2a496cb44939: Preparing
da3ac26fdf0f: Preparing
7b2903554e63: Preparing
6c0e59fd138a: Preparing
aa0fc249df10: Preparing
f35bcec50d8c: Preparing
660f9a93104f: Preparing
53998a5033c3: Preparing
989e799e6349: Preparing
f35bcec50d8c: Waiting
660f9a93104f: Waiting
53998a5033c3: Waiting
989e799e6349: Waiting
6c0e59fd138a: Layer already exists
da3ac26fdf0f: Layer already exists
7b2903554e63: Layer already exists
aa0fc249df10: Layer already exists
989e799e6349: Layer already exists
53998a5033c3: Layer already exists
f35bcec50d8c: Layer already exists
660f9a93104f: Layer already exists
2a496cb44939: Pushed
latest: digest: sha256:ae5687f2c95e8726b815be97f0ad31358cd9f6f2b334668c544c6591e6651261 size: 2199
[Pipeline] }
[Pipeline] // withEnv
[Pipeline] }
[Pipeline] // withDockerRegistry
[Pipeline] }
[Pipeline] // script
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Deploy to Kubernetes)
[Pipeline] sh
+ kubectl apply -f deployment.yaml
deployment.apps/webapp-deployment configured
+ kubectl apply -f service.yaml
service/webapp-service unchanged
+ kubectl apply -f hpa.yaml
horizontalpodautoscaler.autoscaling/webapp-hpa unchanged
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Verify Deployment)
[Pipeline] sh
+ kubectl get pods
NAME                                 READY   STATUS              RESTARTS       AGE
kubeshark-front-67c6fb68c8-mjnff     1/1     Running             18 (43m ago)   19d
kubeshark-hub-6f5d596c87-7297c       1/1     Running             14 (43m ago)   19d
kubeshark-worker-daemon-set-vcd2w    2/2     Running             16 (44m ago)   19d
nginx-deployment-6c98d67c-k6bkf      1/1     Running             2 (44m ago)    11d
nginx-deployment-6c98d67c-kcs7c      1/1     Running             2 (44m ago)    11d
nginx-deployment-6c98d67c-npt4l      1/1     Running             2 (44m ago)    11d
spring-7766fbc7c6-58znh              1/1     Running             2 (44m ago)    11d
spring-7766fbc7c6-pkzf5              1/1     Running             2 (44m ago)    11d
spring-7766fbc7c6-q44lv              1/1     Running             2 (44m ago)    11d
webapp-deployment-5b5894b88b-fvzcq   0/1     ImagePullBackOff    0              11m
webapp-deployment-5b5894b88b-phccz   0/1     ImagePullBackOff    0              11m
webapp-deployment-679c9d78cc-nwwlp   0/1     ContainerCreating   0              2s
+ kubectl get svc
NAME                       TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)        AGE
kubernetes                 ClusterIP   10.96.0.1        <none>        443/TCP        25d
kubeshark-front            ClusterIP   10.96.97.239     <none>        80/TCP         19d
kubeshark-hub              ClusterIP   10.96.67.54      <none>        80/TCP         19d
kubeshark-hub-metrics      ClusterIP   10.107.244.76    <none>        9100/TCP       19d
kubeshark-worker-metrics   ClusterIP   10.97.61.12      <none>        49100/TCP      19d
my-service                 NodePort    10.108.244.1     <none>        80:30007/TCP   20d
webapp-service             NodePort    10.111.110.167   <none>        80:30010/TCP   9m2s
+ kubectl get hpa
NAME         REFERENCE                      TARGETS              MINPODS   MAXPODS   REPLICAS   AGE
webapp-hpa   Deployment/webapp-deployment   cpu: <unknown>/20%   2         5         2          9m1s
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Declarative: Post Actions)
[Pipeline] echo
Deployment Successful!
[Pipeline] }
[Pipeline] // stage
[Pipeline] }
[Pipeline] // withEnv
[Pipeline] }
[Pipeline] // withEnv
[Pipeline] }
[Pipeline] // node
[Pipeline] End of Pipeline
Finished: SUCCESS
